PREFIXES:
		PREFIX isro: <http://www.arbi.com//BuiltInPlan#>;


PLAN CONCLUDE relationChanged($context) {
	ID: "http://www.arbi.com//BuiltInPlan#RelationChangedRobotAt"
	PRECONDITION:
		FACT Communication($communicationInstance);
		FACT GLUtility($glUtility);
		$glUtility.retrieveGLName($context) == "RobotAt";
		FACT ExtraUtility($helper);
	BODY:

		$robot = $glUtility.retrieveGLExpression($context, 0);
		$vertex1 = $glUtility.retrieveGLExpression($context, 1);
		$vertex2 = $glUtility.retrieveGLExpression($context, 2);
		
		$oldData = "(RobotAt \"" + $robot + "\" $oldVertex1 $oldVertex2)";
		$newData = "(RobotAt \"" + $robot + "\" " + $vertex1 + " " + $vertex2 + ")";
		
		$helper.sleepAwhile(50);
		$communicationInstance.updateFact("(update (context " + $oldData + ") (context "+ $newData + "))");
		
		RETRACT relationChanged($context);
		
	UTILITY : 1;
}

PLAN CONCLUDE relationChanged($context) {
	ID: "http://www.arbi.com//BuiltInPlan#RelationChangedBatteryRemain"
	PRECONDITION:
		FACT Communication($communicationInstance);
		FACT GLUtility($glUtility);
		$glUtility.retrieveGLName($context) == "BatteryRemain";
		FACT ExtraUtility($helper);
	BODY:

		$robot = $glUtility.retrieveGLExpression($context, 0);
		$battery = $glUtility.retrieveGLExpression($context, 1);
		
		$oldData = "(BatteryRemain \"" + $robot + "\" $oldBattery)";
		$newData = "(BatteryRemain \"" + $robot + "\" " + $battery + ")";
		
		$helper.sleepAwhile(50);
		$communicationInstance.updateFact("(update (context " + $oldData + ") (context "+ $newData + "))");
		
		RETRACT relationChanged($context);
		
	UTILITY : 1;
}
PLAN CONCLUDE relationChanged($context) {
	ID: "http://www.arbi.com//BuiltInPlan#relationChangedRobotVelocity"
	PRECONDITION:
		FACT Communication($communicationInstance);
		FACT GLUtility($glUtility);
		$glUtility.retrieveGLName($context) == "RobotVelocity";
		FACT ExtraUtility($helper);
	BODY:

		$robot = $glUtility.retrieveGLExpression($context, 0);
		$velocity = $glUtility.retrieveGLExpression($context, 1);
		
		$oldData = "(RobotVelocity \"" + $robot + "\" $oldVelocity)";
		$newData = "(RobotVelocity \"" + $robot + "\" " + $velocity + ")";
		
		$helper.sleepAwhile(50);
		$communicationInstance.updateFact("(update (context " + $oldData + ") (context "+ $newData + "))");
		
		RETRACT relationChanged($context);
	
	UTILITY : 1;
}

PLAN CONCLUDE relationChanged($context) {
	ID: "http://www.arbi.com//BuiltInPlan#relationChangedOnRobotTaskStatus"
	PRECONDITION:
		FACT Communication($communicationInstance);
		FACT GLUtility($glUtility);
		$glUtility.retrieveGLName($context) == "OnRobotTaskStatus";
		FACT ExtraUtility($helper);
	BODY:

		$robot =  $glUtility.retrieveGLExpression($context, 0);
		$status =  $glUtility.retrieveGLExpression($context, 1);
		
		$oldData = "(OnRobotTaskStatus \"" + $robot + "\" $oldStatus)";
		$newData = "(OnRobotTaskStatus \"" + $robot + "\" \"" + $status + "\")";
		
		
		$helper.sleepAwhile(50);
		$communicationInstance.updateFact("(update (context " + $oldData + ") (context "+ $newData + "))");
		
		RETRACT relationChanged($context);
	UTILITY : 1;
}

PLAN CONCLUDE relationChanged($context) {
	ID: "http://www.arbi.com//BuiltInPlan#relationChangedOnAgentTaskStatus"
	PRECONDITION:
		FACT Communication($communicationInstance);
		FACT GLUtility($glUtility);
		$glUtility.retrieveGLName($context) == "OnAgentTaskStatus";
		FACT ExtraUtility($helper);
	BODY:

		$agent = $glUtility.retrieveGLExpression($context, 0);
		
		$task  = $glUtility.retrieveGLExpression($context, 1);
		
		$status = $glUtility.retrieveGLExpression($context, 2);
		
		
		$oldData = "(OnAgentTaskStatus \"" + $agent + "\" $oldTask $oldStatus)";
		$newData = "(OnAgentTaskStatus \"" + $agent + "\" \"" + $task + "\" \"" + $status + "\")";
		
		$helper.sleepAwhile(50);
		$communicationInstance.updateFact("(update (context " + $oldData + ") (context "+ $newData + "))");
		
		RETRACT relationChanged($context);

	UTILITY : 1;
}
